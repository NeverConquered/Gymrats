<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>GymRats - User Profile</title>
        <link rel="stylesheet" type="text/css" href="/userdashboard/userdashboard.css" />
        <link rel="stylesheet" type="text/css" href="/userprofile/userprofile.css" />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/js/all.min.js"></script>
    </head>
    <body>
        <!-- Replace the current header section in userprofile.ejs -->
<!-- User Dashboard Header -->
<div class="main-navbar">
    <header>
        <!-- Header Branding -->
        <div class="brand-logo">
            <a href="<%= user && user.membership ? '/userdashboard_' + user.membership.charAt(0).toLowerCase() : '/dashboard' %>" class="brand-name">GymRats</a>
        </div>
        
        <div class="nav-menu">
            <!-- Add 'active' class conditionally based on the current page -->
            <a href="<%= user && user.membership ? '/userdashboard_' + user.membership.charAt(0).toLowerCase() : '/dashboard' %>" class="<%= currentPage === 'dashboard' ? 'active' : '' %>">Home</a>
            <a href="/user_exercises" class="<%= currentPage === 'exercises' ? 'active' : '' %>">Exercises</a>
            <a href="/user_nutrition" class="<%= currentPage === 'nutrition' ? 'active' : '' %>">Nutrition</a>
        </div>
        
        <div class="right-container">
            <div class="search-container">
                <img src="/userdashboard/icons8-search.svg" height="18px" alt="Search Icon" />
                <input type="text" placeholder="Search..." size="20" style="font-size: 14px;" />
            </div>
            
            <div class="user-profile">
                <a href="/userprofile" class="<%= currentPage === 'profile' ? 'active' : '' %>">
                    <% if (user && user.name) { %>
                        <span><%= user.name %></span>
                    <% } else if (user && user.full_name) { %>
                        <span><%= user.full_name.split(' ')[0] %></span>
                    <% } else { %>
                        <span>User</span>
                    <% } %>
                </a>
            </div>
        </div>
        <div class="mobile-menu-icon" id="menuIcon">
            <img src="/userdashboard/menu.jpg" alt="Menu" height="25px" />
        </div>
        <div class="mobile-sidebar" id="sideNavbar">
            <a href="javascript:void(0)" class="close-button" id="closeBtn">&times;</a>
            <a href="<%= user && user.membership ? '/userdashboard_' + user.membership.charAt(0).toLowerCase() : '/dashboard' %>" class="<%= currentPage === 'dashboard' ? 'active' : '' %>">Home</a>
            <a href="/user_exercises" class="<%= currentPage === 'exercises' ? 'active' : '' %>">Exercises</a>
            <a href="/user_nutrition" class="<%= currentPage === 'nutrition' ? 'active' : '' %>">Nutrition</a>
            <div class="sidebar-profile">
                <a href="/userprofile">
                    <% if (user && user.name) { %>
                        <span><%= user.name %></span>
                    <% } else if (user && user.full_name) { %>
                        <span><%= user.full_name.split(' ')[0] %></span>
                    <% } else { %>
                        <span>User</span>
                    <% } %>
                </a>
            </div>
        </div>
    </header>
</div>
    <!-- Profile Hero Section -->
    <section class="profile-hero">
        <div class="profile-hero-content">
            <h1>My Profile</h1>
            <p>View and manage your personal information and statistics</p>
        </div>
    </section>

    <!-- Main Content Area -->
    <div class="profile-container">
        <!-- Modal for All Workouts -->
        <div id="allWorkoutsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>All Workouts</h2>
                    <span class="close-modal">&times;</span>
                </div>
                <div class="modal-body">
                    <div class="workout-history all-workouts">
                        <!-- Workouts will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Modal for Workout Details -->
        <div id="workoutDetailsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="workoutDetailTitle">Workout Details</h2>
                    <span class="close-modal">&times;</span>
                </div>
                <div class="modal-body" id="workoutDetailContent">
                    <!-- Workout details will be populated by JavaScript -->
                </div>
            </div>
        </div>
        <!-- Profile Overview -->
        <div class="profile-grid">
            <!-- User Information Card -->
            <div class="profile-card user-info-card">
                <div class="card-header">
                    <h2>Personal Information</h2>
                    <button class="edit-btn" id="editProfileBtn"><i class="fas fa-edit"></i> Edit</button>
                </div>
                <div class="profile-content">
                    <div class="profile-status-container">
                        <div class="profile-status">Active Member</div>
                    </div>
                    <!-- Personal Information section -->
<!-- Replace the profile-details section in userprofile.ejs -->
<!-- Update these profile items in userprofile.ejs -->
<div class="profile-details">

    <div class="profile-item">
        <span class="profile-label">Name:</span>
        <span class="profile-value">
            <% if (user && typeof user === 'object') { %>
                <%= user.full_name || user.name || 'Not provided' %>
            <% } else { %>
                Not provided
            <% } %>
        </span>
        <input type="text" class="profile-edit-input" value="<%= user && typeof user === 'object' ? (user.full_name || user.name || '') : '' %>" style="display: none;">
    </div>
    <div class="profile-item">
        <span class="profile-label">Email:</span>
        <span class="profile-value">
            <% if (typeof user === 'object' && user !== null && user.email) { %>
                <%= user.email %>
            <% } else { %>
                Not provided
            <% } %>
        </span>
        <input type="email" class="profile-edit-input" value="<%= typeof user === 'object' && user !== null && user.email ? user.email : '' %>" style="display: none;">
    </div>
    <div class="profile-item">
        <span class="profile-label">Phone:</span>
        <span class="profile-value">
            <% if (typeof user === 'object' && user !== null && user.phone) { %>
                <%= user.phone %>
            <% } else { %>
                Not provided
            <% } %>
        </span>
        <input type="tel" class="profile-edit-input" value="<%= typeof user === 'object' && user !== null && user.phone ? user.phone : '' %>" style="display: none;">
    </div>
    
    <div class="profile-item">
        <span class="profile-label">Age:</span>
        <span class="profile-value">
            <% if (typeof user === 'object' && user !== null && user.dob) { 
                try {
                    const today = new Date();
                    const birthDate = new Date(user.dob);
                    let age = today.getFullYear() - birthDate.getFullYear();
                    const m = today.getMonth() - birthDate.getMonth();
                    if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
                        age--;
                    }
                    %>
                    <%= age %> years
                <% } catch(e) { %>
                    Not provided
                <% }
            } else { %>
                Not provided
            <% } %>
        </span>
        <input type="number" class="profile-edit-input" value="" style="display: none;">
    </div>
    <!-- Height field -->
    <div class="profile-item">
        <span class="profile-label">Height:</span>
        <span class="profile-value">
            <% if (typeof user === 'object' && user !== null && user.height) { %>
                <%= user.height %> cm
            <% } else { %>
                Not provided
            <% } %>
        </span>
        <input type="number" class="profile-edit-input" value="<%= typeof user === 'object' && user !== null && user.height ? user.height : '' %>" style="display: none;">
    </div>
    <!-- Weight field -->
    <div class="profile-item">
        <span class="profile-label">Weight:</span>
        <span class="profile-value">
            <% if (typeof user === 'object' && user !== null && user.weight) { %>
                <%= user.weight %> kg
            <% } else { %>
                Not provided
            <% } %>
        </span>
        <input type="number" class="profile-edit-input" value="<%= typeof user === 'object' && user !== null && user.weight ? user.weight : '' %>" style="display: none;">
    </div>
    <!-- BMI field -->
    <div class="profile-item">
        <span class="profile-label">BMI:</span>
        <span class="profile-value">
            <% if (typeof user === 'object' && user !== null && user.BMI) { %>
                <%= user.BMI %>
            <% } else { %>
                Not provided
            <% } %>
        </span>
        <input type="number" class="profile-edit-input" value="<%= typeof user === 'object' && user !== null && user.BMI ? user.BMI : '' %>" style="display: none;">
    </div>
</div>
                    <div class="profile-edit-actions" style="display: none;">
                        <button class="save-btn" id="saveProfileBtn">Save Changes</button>
                        <button class="cancel-btn" id="cancelEditBtn">Cancel</button>
                    </div>
                </div>
            </div>

            <!-- Membership Card -->
            <!-- Simple fix for userprofile.ejs - replace the membership section -->

<!-- Membership Card -->
<div class="profile-card membership-card">
    <div class="card-header">
        <h2>Membership Details</h2>
    </div>
    <div class="profile-content">
        <div class="membership-status">
            <div class="membership-badge premium">
                <%= user && user.membershipType ? user.membershipType : 'Basic' %> Member
            </div>
            <p class="membership-since">Member since: 
                <% if (user && user.created_at) { %>
                    <%= new Date(user.created_at).toLocaleDateString() %>
                <% } else { %>
                    March 15, 2023
                <% } %>
            </p>
        </div>
        <div class="membership-details">
            <div class="membership-item">
                <span class="membership-label">Plan:</span>
                <span class="membership-value">
                    <%= user && user.membershipType ? user.membershipType : 'Basic' %>
                </span>
            </div>
            <div class="membership-item">
                <span class="membership-label">Renewal Date:</span>
                <span class="membership-value">March 15, 2024</span>
            </div>
            <div class="membership-item">
                <span class="membership-label">Status:</span>
                <span class="membership-value active">
                    <%= user && user.status ? user.status : 'Active' %>
                </span>
            </div>
        </div>
        <div class="membership-features">
            <h3>Features Included:</h3>
            <ul class="features-list">
                <li><i class="fas fa-check"></i> Unlimited workout plans</li>
                <li><i class="fas fa-check"></i> Personal trainer consultations</li>
                <li><i class="fas fa-check"></i> Nutrition planning</li>
                <li><i class="fas fa-check"></i> Advanced progress tracking</li>
            </ul>
        </div>
    </div>
</div>
        </div>

        <!-- Statistics Card -->
        <div class="profile-wide-card">
            <div class="card-header">
                <h2>My Fitness Statistics</h2>
                <div class="card-actions">
                    <select id="statsTimeframeSelect" class="select-dropdown">
                        <option value="month">Last Month</option>
                        <option value="3months">Last 3 Months</option>
                        <option value="6months">Last 6 Months</option>
                        <option value="year">Last Year</option>
                    </select>
                </div>
            </div>
            <div class="stats-content">
                <div class="stats-summary">
                    <div class="stat-summary-card">
                        <div class="stat-icon"><i class="fas fa-dumbbell"></i></div>
                        <div class="stat-number" id="workoutCount">42</div>
                        <div class="stat-label">Workouts</div>
                    </div>
                    <div class="stat-summary-card">
                        <div class="stat-icon"><i class="fas fa-fire"></i></div>
                        <div class="stat-number" id="caloriesBurned">48,650</div>
                        <div class="stat-label">Calories Burned</div>
                    </div>
                    <div class="stat-summary-card">
                        <div class="stat-icon"><i class="fas fa-clock"></i></div>
                        <div class="stat-number" id="hoursActive">64</div>
                        <div class="stat-label">Hours Active</div>
                    </div>
                    <div class="stat-summary-card">
                        <div class="stat-icon"><i class="fas fa-trophy"></i></div>
                        <div class="stat-number" id="goalsAchieved">12</div>
                        <div class="stat-label">Goals Achieved</div>
                    </div>
                </div>
                
                <div class="stats-charts">
                    <div class="chart-container">
                        <h3>Workout Frequency</h3>
                        <canvas id="workoutFrequencyChart"></canvas>
                    </div>
                    
                    <div class="chart-container">
                        <h3>Weight Progress</h3>
                        <canvas id="weightProgressChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Workout History Card -->
        <div class="profile-wide-card">
            <div class="card-header">
                <h2>Recent Workouts</h2>
                <button class="view-all-btn">View All</button>
            </div>
            <div class="profile-content">
                <!-- Replace the workout history section in userprofile.ejs -->
<div class="workout-history">
    <!-- Loop through recent workouts -->
    <% 
    // Default workouts if none exist in the database
    const mockWorkouts = [
        { day: '16', month: 'MAR', name: 'HIIT Training', duration: '45 min', calories: '450', exercises: '4', rating: 4 },
        { day: '14', month: 'MAR', name: 'Strength Training', duration: '60 min', calories: '380', exercises: '6', rating: 5 },
        { day: '12', month: 'MAR', name: 'Cardio Run', duration: '30 min', calories: '320', exercises: '1', rating: 4 }
    ];
    
    // Check if user has workout history
    let recentWorkouts = [];
    if (user && user.workout_history && Array.isArray(user.workout_history)) {
        recentWorkouts = user.workout_history.slice(0, 3);
    } else {
        // Use empty array instead of mocks since we don't want to display fake data
        recentWorkouts = [];
    }
    %>
    
    <% if (recentWorkouts.length > 0) { %>
        <% recentWorkouts.forEach(workout => { %>
            <div class="workout-item" data-workout-id="<%= workout.id || '' %>">
                <div class="workout-date">
                    <span class="workout-day"><%= workout.day %></span>
                    <span class="workout-month"><%= workout.month %></span>
                </div>
                <div class="workout-info">
                    <h3 class="workout-name"><%= workout.name %></h3>
                    <div class="workout-stats">
                        <span><i class="fas fa-clock"></i> <%= workout.duration %></span>
                        <span><i class="fas fa-fire-alt"></i> <%= workout.calories %> cal</span>
                        <span><i class="fas fa-dumbbell"></i> <%= workout.exercises %> exercises</span>
                    </div>
                </div>
                <div class="workout-rating">
                    <% for (let i = 1; i <= 5; i++) { %>
                        <i class="fas fa-star <%= i <= workout.rating ? 'active' : '' %>"></i>
                    <% } %>
                </div>
            </div>
        <% }); %>
    <% } else { %>
        <div class="no-workouts-message">
            <p>No workout history available yet. Start tracking your workouts to see them here!</p>
        </div>
    <% } %>
</div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="site-footer">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>GymRats</h3>
                    <ul>
                        <li><a href="/about">About Us</a></li>
                        <li><a href="/trainers">Our Trainers</a></li>
                        <li><a href="/testimonial">Testimonials</a></li>
                        <li><a href="/blog">Blog</a></li>
                    </ul>
                </div>

                <div class="footer-column">
                    <h3>Resources</h3>
                    <ul>
                        <li><a href="/isolation">Exercise Guide</a></li>
                        <li><a href="/nutrition">Nutrition Tips</a></li>
                        <li><a href="/workout_plans">Workout Plans</a></li>
                        <li><a href="/calculators">Calculators</a></li>
                    </ul>
                </div>

                <div class="footer-column">
                    <h3>Support</h3>
                    <ul>
                        <li><a href="/contact">Contact Us</a></li>
                        <li><a href="/about">About us</a></li>
                        <li><a href="/terms">Terms of Service</a></li>
                        <li><a href="/privacy_policy">Privacy Policy</a></li>
                    </ul>
                </div>

                <div class="footer-column">
                    <h3>Connect With Us</h3>
                    <ul>
                        <li><a href="/login_signup">Become a Trainer</a></li>
                        <li><a href="/verifier_login">Become a Verifier</a></li>
                    </ul>
                    <div class="social-icons">
                        <a href="#"><img src="/userdashboard/icons8-facebook.svg" alt="Facebook"></a>
                        <a href="#"><img src="/userdashboard/icons8-instagram.svg" alt="Instagram"></a>
                        <a href="#"><img src="/userdashboard/icons8-youtube.svg" alt="YouTube"></a>
                    </div>
                    <p class="copyright">GymRats © 2025. All rights reserved.</p>
                </div>
            </div>
        </footer>
    </div>

</body>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Mobile menu functionality
    const menuIcon = document.getElementById('menuIcon');
    const closeBtn = document.getElementById('closeBtn');
    const sideNavbar = document.getElementById('sideNavbar');

    if (menuIcon && closeBtn && sideNavbar) {
        menuIcon.addEventListener('click', function() {
            sideNavbar.style.width = '250px';
        });

        closeBtn.addEventListener('click', function() {
            sideNavbar.style.width = '0';
        });
    }

    // Profile editing functionality
    const editProfileBtn = document.getElementById('editProfileBtn');
    const saveProfileBtn = document.getElementById('saveProfileBtn');
    const cancelEditBtn = document.getElementById('cancelEditBtn');
    const profileImgOverlay = document.getElementById('profileImgOverlay');
    const profilePictureInput = document.getElementById('profilePictureInput');
    const profileImage = document.getElementById('profileImage');

    if (editProfileBtn) {
        editProfileBtn.addEventListener('click', enableProfileEditing);
    }

    if (saveProfileBtn) {
        saveProfileBtn.addEventListener('click', saveProfileChanges);
    }

    if (cancelEditBtn) {
        cancelEditBtn.addEventListener('click', cancelProfileEditing);
    }

    if (profileImgOverlay) {
        profileImgOverlay.addEventListener('click', function() {
            profilePictureInput.click();
        });
    }

    if (profilePictureInput) {
        profilePictureInput.addEventListener('change', function(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    profileImage.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        });
    }

    function enableProfileEditing() {
        // Show profile image overlay
        if (profileImgOverlay) {
            profileImgOverlay.classList.add('active');
        }

        // Replace value elements with input fields
        const profileItems = document.querySelectorAll('.profile-item');
        profileItems.forEach(item => {
            const valueElement = item.querySelector('.profile-value');
            const inputElement = item.querySelector('.profile-edit-input');
            
            if (valueElement && inputElement) {
                valueElement.style.display = 'none';
                inputElement.style.display = 'block';
            }
        });

        // Show edit actions buttons
        const editActions = document.querySelector('.profile-edit-actions');
        if (editActions) {
            editActions.style.display = 'flex';
        }

        // Hide the edit button
        editProfileBtn.style.display = 'none';
    }

    function saveProfileChanges() {
        // Update profile values from inputs
        const profileItems = document.querySelectorAll('.profile-item');
        profileItems.forEach(item => {
            const valueElement = item.querySelector('.profile-value');
            const inputElement = item.querySelector('.profile-edit-input');
            
            if (valueElement && inputElement) {
                // Update the displayed value with the input value
                if (inputElement.tagName.toLowerCase() === 'select') {
                    valueElement.textContent = inputElement.options[inputElement.selectedIndex].text;
                } else {
                    valueElement.textContent = inputElement.value;
                }
                
                // Hide input, show value
                valueElement.style.display = 'block';
                inputElement.style.display = 'none';
            }
        });

        // Hide profile image overlay
        if (profileImgOverlay) {
            profileImgOverlay.classList.remove('active');
        }

        // Hide edit actions buttons
        const editActions = document.querySelector('.profile-edit-actions');
        if (editActions) {
            editActions.style.display = 'none';
        }

        // Show the edit button
        editProfileBtn.style.display = 'flex';
    }

    function cancelProfileEditing() {
        // Hide the inputs without saving changes
        const profileItems = document.querySelectorAll('.profile-item');
        profileItems.forEach(item => {
            const valueElement = item.querySelector('.profile-value');
            const inputElement = item.querySelector('.profile-edit-input');
            
            if (valueElement && inputElement) {
                // Reset input value to match displayed value
                if (inputElement.tagName.toLowerCase() === 'select') {
                    // Find and select the option that matches the current value
                    for (let i = 0; i < inputElement.options.length; i++) {
                        if (inputElement.options[i].text === valueElement.textContent.trim()) {
                            inputElement.selectedIndex = i;
                            break;
                        }
                    }
                } else {
                    inputElement.value = valueElement.textContent;
                }
                
                // Hide input, show value
                valueElement.style.display = 'block';
                inputElement.style.display = 'none';
            }
        });

        // Reset profile image if it was changed
        // Note: We would need to store the original image URL to truly reset it

        // Hide profile image overlay
        if (profileImgOverlay) {
            profileImgOverlay.classList.remove('active');
        }

        // Hide edit actions buttons
        const editActions = document.querySelector('.profile-edit-actions');
        if (editActions) {
            editActions.style.display = 'none';
        }

        // Show the edit button
        editProfileBtn.style.display = 'flex';
    }

    // Chart.js setup for dynamic statistics charts
    setupCharts();

    // Handle timeframe change for statistics
    const statsTimeframeSelect = document.getElementById('statsTimeframeSelect');
    if (statsTimeframeSelect) {
        statsTimeframeSelect.addEventListener('change', function() {
            updateStatistics(this.value);
        });
    }
    
    // Modal functionality
    setupModals();
    
    // Setup workout interactions - View All and Details buttons
    setupWorkoutInteractions();
});

// Chart configuration and setup
function setupCharts() {
    // Workout Frequency Chart
    const workoutFrequencyCtx = document.getElementById('workoutFrequencyChart');
    if (workoutFrequencyCtx) {
        window.workoutFrequencyChart = new Chart(workoutFrequencyCtx, {
            type: 'bar',
            data: getWorkoutFrequencyData('month'),
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            color: '#aaa'
                        },
                        grid: {
                            color: 'rgba(255, 255, 255, 0.1)'
                        }
                    },
                    x: {
                        ticks: {
                            color: '#aaa'
                        },
                        grid: {
                            display: false
                        }
                    }
                }
            }
        });
    }

    // Weight Progress Chart
    const weightProgressCtx = document.getElementById('weightProgressChart');
    if (weightProgressCtx) {
        window.weightProgressChart = new Chart(weightProgressCtx, {
            type: 'line',
            data: getWeightProgressData('month'),
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'top',
                        labels: {
                            color: '#aaa'
                        }
                    }
                },
                scales: {
                    y: {
                        ticks: {
                            color: '#aaa'
                        },
                        grid: {
                            color: 'rgba(255, 255, 255, 0.1)'
                        }
                    },
                    x: {
                        ticks: {
                            color: '#aaa'
                        },
                        grid: {
                            display: false
                        }
                    }
                }
            }
        });
    }
}

// Update statistics based on selected timeframe
function updateStatistics(timeframe) {
    // Update summary cards
    updateSummaryCards(timeframe);
    
    // Update charts
    if (window.workoutFrequencyChart) {
        window.workoutFrequencyChart.data = getWorkoutFrequencyData(timeframe);
        window.workoutFrequencyChart.update();
    }
    
    if (window.weightProgressChart) {
        window.weightProgressChart.data = getWeightProgressData(timeframe);
        window.weightProgressChart.update();
    }
}

// Update summary cards with timeframe data
function updateSummaryCards(timeframe) {
    // Get data for the selected timeframe
    const summaryData = getSummaryData(timeframe);
    
    // Update the DOM elements
    document.getElementById('workoutCount').textContent = summaryData.workouts;
    document.getElementById('caloriesBurned').textContent = summaryData.calories;
    document.getElementById('hoursActive').textContent = summaryData.hours;
    document.getElementById('goalsAchieved').textContent = summaryData.goals;
}

// Get summary data for different timeframes
function getSummaryData(timeframe) {
    const data = {
        month: {
            workouts: '42',
            calories: '48,650',
            hours: '64',
            goals: '12'
        },
        '3months': {
            workouts: '112',
            calories: '132,450',
            hours: '168',
            goals: '28'
        },
        '6months': {
            workouts: '224',
            calories: '248,750',
            hours: '312',
            goals: '42'
        },
        year: {
            workouts: '395',
            calories: '517,800',
            hours: '568',
            goals: '65'
        }
    };
    
    return data[timeframe] || data.month;
}

// Get workout frequency data for the chart
function getWorkoutFrequencyData(timeframe) {
    let labels, data;
    
    switch(timeframe) {
        case 'month':
            labels = ['Week 1', 'Week 2', 'Week 3', 'Week 4'];
            data = [10, 12, 8, 12];
            break;
        case '3months':
            labels = ['Jan', 'Feb', 'Mar'];
            data = [38, 42, 32];
            break;
        case '6months':
            labels = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'];
            data = [38, 42, 32, 40, 36, 36];
            break;
        case 'year':
            labels = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            data = [38, 42, 32, 40, 36, 36, 30, 28, 34, 42, 38, 29];
            break;
        default:
            labels = ['Week 1', 'Week 2', 'Week 3', 'Week 4'];
            data = [10, 12, 8, 12];
    }
    
    return {
        labels: labels,
        datasets: [{
            label: 'Workouts',
            data: data,
            backgroundColor: 'rgba(138, 43, 226, 0.7)',
            borderColor: '#8A2BE2',
            borderWidth: 1
        }]
    };
}

// Get weight progress data for the chart
function getWeightProgressData(timeframe) {
    let labels, weightData;
    
    switch(timeframe) {
        case 'month':
            labels = ['Week 1', 'Week 2', 'Week 3', 'Week 4'];
            weightData = [77, 76.5, 75.8, 75];
            break;
        case '3months':
            labels = ['Jan', 'Feb', 'Mar'];
            weightData = [80, 77, 75];
            break;
        case '6months':
            labels = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'];
            weightData = [82, 80, 77, 76, 75.5, 75];
            break;
        case 'year':
            labels = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            weightData = [85, 84, 82, 80, 78, 77, 76, 75.5, 75, 74.5, 74, 75];
            break;
        default:
            labels = ['Week 1', 'Week 2', 'Week 3', 'Week 4'];
            weightData = [77, 76.5, 75.8, 75];
    }
    
    return {
        labels: labels,
        datasets: [{
            label: 'Weight (kg)',
            data: weightData,
            borderColor: '#4CAF50',
            backgroundColor: 'rgba(76, 175, 80, 0.1)',
            borderWidth: 2,
            fill: true,
            tension: 0.4
        }]
    };
}

// Setup modal functionality
function setupModals() {
    const allModals = document.querySelectorAll('.modal');
    const closeButtons = document.querySelectorAll('.close-modal');
    
    // Close modal when clicking the close button
    closeButtons.forEach(button => {
        button.addEventListener('click', function() {
            const modal = this.closest('.modal');
            if (modal) {
                modal.classList.remove('active');
                // Allow body to scroll again
                document.body.style.overflow = 'auto';
            }
        });
    });
    
    // Close modal when clicking outside the modal content
    allModals.forEach(modal => {
        modal.addEventListener('click', function(event) {
            if (event.target === this) {
                modal.classList.remove('active');
                // Allow body to scroll again
                document.body.style.overflow = 'auto';
            }
        });
    });
    
    // Close modal with Escape key
    document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
            allModals.forEach(modal => {
                if (modal.classList.contains('active')) {
                    modal.classList.remove('active');
                    // Allow body to scroll again
                    document.body.style.overflow = 'auto';
                }
            });
        }
    });
}

// Setup workout interactions
function setupWorkoutInteractions() {
    // View All button functionality
    const viewAllBtn = document.querySelector('.view-all-btn');
    const allWorkoutsModal = document.getElementById('allWorkoutsModal');
    
    if (viewAllBtn && allWorkoutsModal) {
        viewAllBtn.addEventListener('click', function() {
            // Populate with all workouts
            populateAllWorkouts();
            
            // Show modal
            allWorkoutsModal.classList.add('active');
            
            // Prevent body scrolling when modal is open
            document.body.style.overflow = 'hidden';
        });
    }
    
    // Set up event delegation for workout detail buttons
    document.addEventListener('click', function(event) {
        // Check if the clicked element is a details button or has a parent that is
        const detailsBtn = event.target.closest('.details-btn');
        
        if (detailsBtn) {
            // Get the workout item
            const workoutItem = detailsBtn.closest('.workout-item');
            if (workoutItem) {
                // Get workout name
                const workoutName = workoutItem.querySelector('.workout-name').textContent;
                // Get workout date
                const day = workoutItem.querySelector('.day').textContent;
                const month = workoutItem.querySelector('.month').textContent;
                
                // Show workout details modal
                showWorkoutDetails(workoutName, `${day} ${month}`);
            }
        }
    });
}

// Populate the All Workouts modal
function populateAllWorkouts() {
    const allWorkoutsContainer = document.querySelector('.all-workouts');
    
    if (allWorkoutsContainer) {
        // Clear previous content
        allWorkoutsContainer.innerHTML = '';
        
        // Get workout data
        const workouts = getAllWorkoutsData();
        
        // Create workout items
        workouts.forEach(workout => {
            const workoutItem = document.createElement('div');
            workoutItem.className = 'workout-item';
            
            workoutItem.innerHTML = `
                <div class="workout-date">
                    <div class="date-circle">
                        <span class="day">${workout.day}</span>
                        <span class="month">${workout.month}</span>
                    </div>
                </div>
                <div class="workout-details">
                    <div class="workout-name">${workout.name}</div>
                    <div class="workout-stats">
                        <span><i class="fas fa-clock"></i> ${workout.duration}</span>
                        <span><i class="fas fa-fire"></i> ${workout.calories} calories</span>
                        <span><i class="fas fa-dumbbell"></i> ${workout.exercises} exercises</span>
                    </div>
                </div>
                <div class="workout-rating">
                    <div class="stars">
                        ${getStarsHTML(workout.rating)}
                    </div>
                    <button class="details-btn">Details</button>
                </div>
            `;
            
            allWorkoutsContainer.appendChild(workoutItem);
        });
    }
}

// Generate stars HTML based on rating
function getStarsHTML(rating) {
    let starsHTML = '';
    
    for (let i = 1; i <= 5; i++) {
        if (i <= rating) {
            starsHTML += '<i class="fas fa-star"></i>';
        } else {
            starsHTML += '<i class="far fa-star"></i>';
        }
    }
    
    return starsHTML;
}

// Show workout details in modal
function showWorkoutDetails(workoutName, workoutDate) {
    const detailsModal = document.getElementById('workoutDetailsModal');
    const detailTitle = document.getElementById('workoutDetailTitle');
    const detailContent = document.getElementById('workoutDetailContent');
    
    if (detailsModal && detailTitle && detailContent) {
        // Set modal title
        detailTitle.textContent = `${workoutName} - ${workoutDate}`;
        
        // Get workout details
        const workoutDetail = getWorkoutDetails(workoutName);
        
        // Create content
        let contentHTML = '';
        
        // Add exercises
        workoutDetail.exercises.forEach(exercise => {
            contentHTML += `
                <div class="exercise-item">
                    <div class="exercise-header">
                        <div class="exercise-name">${exercise.name}</div>
                        <div class="exercise-type">${exercise.type}</div>
                    </div>
                    <div class="exercise-sets">
                        <div class="set-row set-header">
                            <div>Set</div>
                            <div>Weight</div>
                            <div>Reps</div>
                            <div>Rest</div>
                        </div>
                        ${exercise.sets.map((set, index) => `
                            <div class="set-row">
                                <div class="set-value">${index + 1}</div>
                                <div class="set-value">${set.weight}</div>
                                <div class="set-value">${set.reps}</div>
                                <div class="set-value">${set.rest}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        });
        
        // Add notes if available
        if (workoutDetail.notes) {
            contentHTML += `
                <div class="workout-notes">
                    <h3>Notes</h3>
                    <p>${workoutDetail.notes}</p>
                </div>
            `;
        }
        
        // Set content
        detailContent.innerHTML = contentHTML;
        
        // Show modal
        detailsModal.classList.add('active');
        
        // Prevent body scrolling
        document.body.style.overflow = 'hidden';
    }
}

// Get all workouts data
function getAllWorkoutsData() {
    // This would typically come from an API, but for this example, we'll use hardcoded data
    return [
        {
            day: '16',
            month: 'MAR',
            name: 'HIIT Training',
            duration: '45 min',
            calories: '450',
            exercises: '4',
            rating: 4
        },
        {
            day: '14',
            month: 'MAR',
            name: 'Strength Training',
            duration: '60 min',
            calories: '380',
            exercises: '6',
            rating: 5
        },
        {
            day: '12',
            month: 'MAR',
            name: 'Cardio Run',
            duration: '30 min',
            calories: '320',
            exercises: '1',
            rating: 4
        },
        {
            day: '10',
            month: 'MAR',
            name: 'Yoga Session',
            duration: '50 min',
            calories: '200',
            exercises: '12',
            rating: 5
        },
        {
            day: '08',
            month: 'MAR',
            name: 'Circuit Training',
            duration: '55 min',
            calories: '480',
            exercises: '8',
            rating: 3
        },
        {
            day: '06',
            month: 'MAR',
            name: 'Swimming',
            duration: '40 min',
            calories: '350',
            exercises: '3',
            rating: 4
        },
        {
            day: '04',
            month: 'MAR',
            name: 'Leg Day',
            duration: '65 min',
            calories: '420',
            exercises: '5',
            rating: 4
        },
        {
            day: '02',
            month: 'MAR',
            name: 'Upper Body',
            duration: '50 min',
            calories: '380',
            exercises: '6',
            rating: 5
        },
        {
            day: '28',
            month: 'FEB',
            name: 'Cycling',
            duration: '60 min',
            calories: '520',
            exercises: '1',
            rating: 5
        },
        {
            day: '26',
            month: 'FEB',
            name: 'Full Body Workout',
            duration: '70 min',
            calories: '550',
            exercises: '10',
            rating: 4
        }
    ];
}

// Get workout details based on workout name
function getWorkoutDetails(workoutName) {
    // This would typically come from an API, but for this example, we'll use hardcoded data
    const workoutDetails = {
        'HIIT Training': {
            exercises: [
                {
                    name: 'Burpees',
                    type: 'HIIT',
                    sets: [
                        { weight: 'Body weight', reps: '12', rest: '30 sec' },
                        { weight: 'Body weight', reps: '10', rest: '30 sec' },
                        { weight: 'Body weight', reps: '8', rest: '30 sec' }
                    ]
                },
                {
                    name: 'Mountain Climbers',
                    type: 'HIIT',
                    sets: [
                        { weight: 'Body weight', reps: '30 sec', rest: '20 sec' },
                        { weight: 'Body weight', reps: '30 sec', rest: '20 sec' },
                        { weight: 'Body weight', reps: '30 sec', rest: '20 sec' }
                    ]
                },
                {
                    name: 'Jump Squats',
                    type: 'HIIT',
                    sets: [
                        { weight: 'Body weight', reps: '15', rest: '30 sec' },
                        { weight: 'Body weight', reps: '15', rest: '30 sec' },
                        { weight: 'Body weight', reps: '15', rest: '30 sec' }
                    ]
                },
                {
                    name: 'Plank to Push-up',
                    type: 'HIIT',
                    sets: [
                        { weight: 'Body weight', reps: '10', rest: '30 sec' },
                        { weight: 'Body weight', reps: '8', rest: '30 sec' },
                        { weight: 'Body weight', reps: '6', rest: '30 sec' }
                    ]
                }
            ],
            notes: 'Complete all exercises in a circuit, repeat 3 times. Rest 1 minute between circuits. Great progress on burpees, but need to improve on the plank to push-ups.'
        },
        'Strength Training': {
            exercises: [
                {
                    name: 'Bench Press',
                    type: 'Chest',
                    sets: [
                        { weight: '135 lbs', reps: '12', rest: '60 sec' },
                        { weight: '155 lbs', reps: '10', rest: '60 sec' },
                        { weight: '175 lbs', reps: '8', rest: '60 sec' },
                        { weight: '185 lbs', reps: '6', rest: '60 sec' }
                    ]
                },
                {
                    name: 'Barbell Row',
                    type: 'Back',
                    sets: [
                        { weight: '135 lbs', reps: '12', rest: '60 sec' },
                        { weight: '155 lbs', reps: '10', rest: '60 sec' },
                        { weight: '175 lbs', reps: '8', rest: '60 sec' }
                    ]
                },
                {
                    name: 'Shoulder Press',
                    type: 'Shoulders',
                    sets: [
                        { weight: '95 lbs', reps: '12', rest: '60 sec' },
                        { weight: '105 lbs', reps: '10', rest: '60 sec' },
                        { weight: '115 lbs', reps: '8', rest: '60 sec' }
                    ]
                },
                {
                    name: 'Bicep Curls',
                    type: 'Arms',
                    sets: [
                        { weight: '40 lbs', reps: '12', rest: '45 sec' },
                        { weight: '45 lbs', reps: '10', rest: '45 sec' },
                        { weight: '50 lbs', reps: '8', rest: '45 sec' }
                    ]
                },
                {
                    name: 'Tricep Extensions',
                    type: 'Arms',
                    sets: [
                        { weight: '60 lbs', reps: '12', rest: '45 sec' },
                        { weight: '70 lbs', reps: '10', rest: '45 sec' },
                        { weight: '80 lbs', reps: '8', rest: '45 sec' }
                    ]
                },
                {
                    name: 'Cable Fly',
                    type: 'Chest',
                    sets: [
                        { weight: '40 lbs', reps: '15', rest: '45 sec' },
                        { weight: '45 lbs', reps: '12', rest: '45 sec' },
                        { weight: '50 lbs', reps: '10', rest: '45 sec' }
                    ]
                }
            ],
            notes: 'New PR on bench press! Felt strong today, increased weights on most exercises. Need to work on shoulder press form.'
        },
        'Cardio Run': {
            exercises: [
                {
                    name: 'Outdoor Run',
                    type: 'Cardio',
                    sets: [
                        { weight: 'N/A', reps: '30 min', rest: 'N/A' }
                    ]
                }
            ],
            notes: 'Ran 3.5 miles at an average pace of 8:34 min/mile. Weather was great, felt energized throughout the run.'
        },
        'Yoga Session': {
            exercises: [
                {
                    name: 'Vinyasa Flow',
                    type: 'Flexibility/Strength',
                    sets: [
                        { weight: 'Body weight', reps: '50 min', rest: 'N/A' }
                    ]
                }
            ],
            notes: 'Focused on hip openers and shoulder mobility. Feeling much more flexible after consistent practice.'
        },
        'Circuit Training': {
            exercises: [
                {
                    name: 'Kettlebell Swings',
                    type: 'Full Body',
                    sets: [
                        { weight: '16 kg', reps: '20', rest: '30 sec' },
                        { weight: '20 kg', reps: '15', rest: '30 sec' },
                        { weight: '24 kg', reps: '12', rest: '30 sec' }
                    ]
                },
                {
                    name: 'Battle Ropes',
                    type: 'Cardio/Arms',
                    sets: [
                        { weight: 'N/A', reps: '30 sec', rest: '30 sec' },
                        { weight: 'N/A', reps: '30 sec', rest: '30 sec' },
                        { weight: 'N/A', reps: '30 sec', rest: '30 sec' }
                    ]
                },
                {
                    name: 'Box Jumps',
                    type: 'Legs/Explosive',
                    sets: [
                        { weight: 'Body weight', reps: '12', rest: '30 sec' },
                        { weight: 'Body weight', reps: '10', rest: '30 sec' },
                        { weight: 'Body weight', reps: '8', rest: '30 sec' }
                    ]
                },
                {
                    name: 'TRX Rows',
                    type: 'Back',
                    sets: [
                        { weight: 'Body weight', reps: '15', rest: '30 sec' },
                        { weight: 'Body weight', reps: '12', rest: '30 sec' },
                        { weight: 'Body weight', reps: '10', rest: '30 sec' }
                    ]
                },
                {
                    name: 'Medicine Ball Slams',
                    type: 'Full Body',
                    sets: [
                        { weight: '20 lbs', reps: '15', rest: '30 sec' },
                        { weight: '20 lbs', reps: '15', rest: '30 sec' },
                        { weight: '20 lbs', reps: '15', rest: '30 sec' }
                    ]
                },
                {
                    name: 'Rowing Machine',
                    type: 'Cardio',
                    sets: [
                        { weight: 'N/A', reps: '250m', rest: '30 sec' },
                        { weight: 'N/A', reps: '250m', rest: '30 sec' },
                        { weight: 'N/A', reps: '250m', rest: '30 sec' }
                    ]
                },
                {
                    name: 'Plank',
                    type: 'Core',
                    sets: [
                        { weight: 'Body weight', reps: '60 sec', rest: '30 sec' },
                        { weight: 'Body weight', reps: '45 sec', rest: '30 sec' },
                        { weight: 'Body weight', reps: '30 sec', rest: '30 sec' }
                    ]
                },
                {
                    name: 'Dumbbell Walking Lunges',
                    type: 'Legs',
                    sets: [
                        { weight: '25 lbs each', reps: '20 steps', rest: '30 sec' },
                        { weight: '30 lbs each', reps: '16 steps', rest: '30 sec' },
                        { weight: '35 lbs each', reps: '12 steps', rest: '30 sec' }
                    ]
                }
            ],
            notes: 'Completed 3 full circuit rounds. Really pushed hard on the battle ropes and rowing machine. Felt exhausted but accomplished!'
        }
    };
    
    // Return the workout details or a default if not found
    return workoutDetails[workoutName] || {
        exercises: [
            {
                name: 'Exercise Information',
                type: 'Not Available',
                sets: [
                    { weight: 'N/A', reps: 'N/A', rest: 'N/A' }
                ]
            }
        ],
        notes: 'Detailed information for this workout is not available.'
    };

    
}
</script>

</html>
